
+-----------------------------------+-----------+--------------------------------------------+------------------------------------------+--------------------------------+
| Statement:                                                                                                                                                             |
|    edges.sender_is("service").receiver_is("service").all_are("encrypted")                                                                                              |
+-----------------------------------+-----------+--------------------------------------------+------------------------------------------+--------------------------------+
| Step                              | Decision  | Node / Edge                                | Stereotypes                              | Traceability                   |
+-----------------------------------+-----------+--------------------------------------------+------------------------------------------+--------------------------------+
| ### Scope transformations ###     |           |                                            |                                          |                                |
| --------------------------------- | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
| 1. receiver_is("service")         | included  | gateway_server -> account_service          | ['restful_http']                         |                                |
|                                   | included  | auth_server -> account_service             | ['restful_http', 'auth_provider']        |                                |
|                                   | included  | auth_server -> customer_service            | ['restful_http', 'auth_provider']        |                                |
|                                   | included  | customer_service -> account_service        | ['restful_http',                         |                                |
|                                   |           |                                            | 'authenticated_request',                 |                                |
|                                   |           |                                            | 'feign_connection',                      |                                |
|                                   |           |                                            | 'load_balanced_link']                    |                                |
|                                   | included  | discovery_server -> gateway_server         | ['restful_http', 'authenticated',        |                                |
|                                   |           |                                            | 'authorized']                            |                                |
|                                   | included  | account_service -> discovery_server        | ['restful_http']                         |                                |
|                                   | included  | auth_server -> discovery_server            | ['restful_http']                         |                                |
|                                   | included  | gateway_server -> auth_server              | ['restful_http', 'auth_provider',        |                                |
|                                   |           |                                            | 'authenticated', 'authorized']           |                                |
|                                   | included  | customer_service -> discovery_server       | ['restful_http']                         |                                |
|                                   | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
| --------------------------------- | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
| 2. sender_is("service")           | included  | gateway_server -> account_service          | ['restful_http']                         |                                |
|                                   | included  | auth_server -> account_service             | ['restful_http', 'auth_provider']        |                                |
|                                   | included  | auth_server -> customer_service            | ['restful_http', 'auth_provider']        |                                |
|                                   | included  | customer_service -> account_service        | ['restful_http',                         |                                |
|                                   |           |                                            | 'authenticated_request',                 |                                |
|                                   |           |                                            | 'feign_connection',                      |                                |
|                                   |           |                                            | 'load_balanced_link']                    |                                |
|                                   | included  | discovery_server -> gateway_server         | ['restful_http', 'authenticated',        |                                |
|                                   |           |                                            | 'authorized']                            |                                |
|                                   | included  | account_service -> discovery_server        | ['restful_http']                         |                                |
|                                   | included  | auth_server -> discovery_server            | ['restful_http']                         |                                |
|                                   | included  | gateway_server -> auth_server              | ['restful_http', 'auth_provider',        |                                |
|                                   |           |                                            | 'authenticated', 'authorized']           |                                |
|                                   | included  | customer_service -> discovery_server       | ['restful_http']                         |                                |
|                                   | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
|                                   | excluded  | user -> gateway_server                     | ['restful_http',                         |                                |
|                                   |           |                                            | 'authenticated_request',                 |                                |
|                                   |           |                                            | 'authenticated', 'authorized']           |                                |
|                                   | excluded  | database_gateway_server -> gateway_server  | ['jdbc', 'plaintext_credentials_link']   |                                |
|                                   | excluded  | database_auth_server -> auth_server        | ['jdbc', 'plaintext_credentials_link']   |                                |
| --------------------------------- | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
| Final scope                       |           | gateway_server -> account_service          |                                          |                                |
|                                   |           | auth_server -> account_service             |                                          |                                |
|                                   |           | auth_server -> customer_service            |                                          |                                |
|                                   |           | customer_service -> account_service        |                                          |                                |
|                                   |           | discovery_server -> gateway_server         |                                          |                                |
|                                   |           | account_service -> discovery_server        |                                          |                                |
|                                   |           | auth_server -> discovery_server            |                                          |                                |
|                                   |           | gateway_server -> auth_server              |                                          |                                |
|                                   |           | customer_service -> discovery_server       |                                          |                                |
| --------------------------------- | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
| ### Property checks ###           |           |                                            |                                          |                                |
| --------------------------------- | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
| 3. all_are("encrypted")           | fails     | account_service -> discovery_server        | ['restful_http']                         |                                |
|                                   | fails     | auth_server -> account_service             | ['restful_http', 'auth_provider']        |                                |
|                                   | fails     | auth_server -> customer_service            | ['restful_http', 'auth_provider']        |                                |
|                                   | fails     | auth_server -> discovery_server            | ['restful_http']                         |                                |
|                                   | fails     | customer_service -> account_service        | ['restful_http',                         |                                |
|                                   |           |                                            | 'authenticated_request',                 |                                |
|                                   |           |                                            | 'feign_connection',                      |                                |
|                                   |           |                                            | 'load_balanced_link']                    |                                |
|                                   | fails     | customer_service -> discovery_server       | ['restful_http']                         |                                |
|                                   | fails     | discovery_server -> gateway_server         | ['restful_http', 'authenticated',        |                                |
|                                   |           |                                            | 'authorized']                            |                                |
|                                   | fails     | gateway_server -> account_service          | ['restful_http']                         |                                |
|                                   | fails     | gateway_server -> auth_server              | ['restful_http', 'auth_provider',        |                                |
|                                   |           |                                            | 'authenticated', 'authorized']           |                                |
|                                   | --------- | ------------------------------------------ | ---------------------------------------- | ------------------------------ |
|                          Verdict  | False     |                                            | Property check requires all to have it,  |                                |
|                                   |           |                                            | only x has it                            |                                |
+-----------------------------------+-----------+--------------------------------------------+------------------------------------------+--------------------------------+