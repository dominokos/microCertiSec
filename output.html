<!DOCTYPE html>    <html>        <body><pre>+----------------------------------+-----------+------------------------+--------------------------------------------------+
| Statement:                                                                                                               |
|    nodes.that_are("entrypoint").all_have("authorization")                                                                |
+----------------------------------+-----------+------------------------+--------------------------------------------------+
| Step                             | Decision  | Node / Edge            | Properties                                       |
+----------------------------------+-----------+------------------------+--------------------------------------------------+
| ### Scope transformations ###    |           |                        |                                                  |
| -------------------------------- | --------- | ---------------------- | ------------------------------------------------ |
| 1. that_are("entrypoint")        | included  | <a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/resources/bootstrap.yml#L3" target="_blank">gateway</a>                | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/java/com/piggymetrics/gateway/GatewayApplication.java#L10" target="_blank">gateway</a>', 'infrastructural', '<a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/java/com/piggymetrics/gateway/GatewayApplication.java#L10" target="_blank">load_balancer</a>',  |
|                                  |           |                        | 'circuit_breaker', 'entrypoint', 'service']      |
|                                  | --------- | ---------------------- | ------------------------------------------------ |
|                                  | excluded  | user                   | ['user_stereotype', 'external_entity']           |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/monitoring/src/main/resources/bootstrap.yml#L3" target="_blank">monitoring</a>             | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/monitoring/src/main/resources/bootstrap.yml#L3" target="_blank">monitoring_dashboard</a>', 'infrastructural',      |
|                                  |           |                        | 'service']                                       |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L3" target="_blank">rabbitmq</a>               | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L3" target="_blank">message_broker</a>', 'infrastructural', 'service'] |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/statistics-service/src/main/resources/bootstrap.yml#L3" target="_blank">statistics_service</a>     | ['internal', '<a href="https://github.com/sqshq/piggymetrics/blob/master/statistics-service/src/main/java/com/piggymetrics/statistics/service/StatisticsServiceImpl.java#L11" target="_blank">local_logging</a>',                    |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/statistics-service/src/main/java/com/piggymetrics/statistics/controller/StatisticsController.java#L25" target="_blank">pre_authorized_endpoints</a>', '<a href="https://github.com/sqshq/piggymetrics/blob/master/statistics-service/src/main/java/com/piggymetrics/statistics/config/ResourceServerConfig.java#L15" target="_blank">resource_server</a>',   |
|                                  |           |                        | 'authentication', 'service']                     |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L95" target="_blank">account_mongodb</a>        | ['database', '<a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L98" target="_blank">plaintext_credentials</a>', 'service'] |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/registry/src/main/resources/bootstrap.yml#L3" target="_blank">registry</a>               | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/registry/src/main/java/com/piggymetrics/registry/RegistryApplication.java#L8" target="_blank">service_discovery</a>', 'plaintext_credentials',   |
|                                  |           |                        | 'infrastructural', 'service']                    |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/notification-service/src/main/resources/bootstrap.yml#L3" target="_blank">notification_service</a>   | ['internal', '<a href="https://github.com/sqshq/piggymetrics/blob/master/notification-service/src/main/java/com/piggymetrics/notification/service/RecipientServiceImpl.java#L7" target="_blank">local_logging</a>', '<a href="https://github.com/sqshq/piggymetrics/blob/master/notification-service/src/main/java/com/piggymetrics/notification/config/ResourceServerConfig.java#L18" target="_blank">resource_server</a>', |
|                                  |           |                        | 'service']                                       |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L146" target="_blank">notification_mongodb</a>   | ['database', '<a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L150" target="_blank">plaintext_credentials</a>', 'service'] |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/resources/bootstrap.yml#L3" target="_blank">auth_service</a>           | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/java/com/piggymetrics/auth/config/OAuth2AuthorizationConfig.java#L22" target="_blank">authorization_server</a>',                         |
|                                  |           |                        | 'authentication_server',                         |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/java/com/piggymetrics/auth/controller/UserController.java#L27" target="_blank">pre_authorized_endpoints</a>', 'infrastructural',   |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/config/src/main/resources/shared/notification-service.yml#L6" target="_blank">token_server</a>', '<a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/java/com/piggymetrics/auth/service/UserServiceImpl.java#L30" target="_blank">encryption</a>', '<a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/java/com/piggymetrics/auth/service/UserServiceImpl.java#L6" target="_blank">local_logging</a>',   |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/java/com/piggymetrics/auth/AuthApplication.java#L10" target="_blank">resource_server</a>', '<a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/java/com/piggymetrics/auth/config/WebSecurityConfig.java#L9" target="_blank">csrf_disabled</a>',              |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/auth-service/src/main/java/com/piggymetrics/auth/config/WebSecurityConfig.java#L9" target="_blank">authentication_scope_all_requests</a>', 'service']  |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/config/pom.xml#L36" target="_blank">config</a>                 | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/config/pom.xml#L36" target="_blank">configuration_server</a>',                         |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/resources/bootstrap.yml#L9" target="_blank">plaintext_credentials</a>', 'infrastructural',      |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/config/src/main/java/com/piggymetrics/config/SecurityConfig.java#L4" target="_blank">csrf_disabled</a>', '<a href="https://github.com/sqshq/piggymetrics/blob/master/config/src/main/java/com/piggymetrics/config/SecurityConfig.java#L4" target="_blank">basic_authentication</a>',         |
|                                  |           |                        | 'authentication', 'service']                     |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/account-service/src/main/resources/bootstrap.yml#L3" target="_blank">account_service</a>        | ['internal', '<a href="https://github.com/sqshq/piggymetrics/blob/master/account-service/src/main/java/com/piggymetrics/account/controller/AccountController.java#L19" target="_blank">pre_authorized_endpoints</a>',         |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/account-service/src/main/java/com/piggymetrics/account/client/StatisticsServiceClientFallback.java#L5" target="_blank">local_logging</a>', '<a href="https://github.com/sqshq/piggymetrics/blob/master/account-service/src/main/java/com/piggymetrics/account/config/ResourceServerConfig.java#L23" target="_blank">resource_server</a>',              |
|                                  |           |                        | '<a href="https://github.com/sqshq/piggymetrics/blob/master/account-service/pom.xml#L61" target="_blank">circuit_breaker</a>', 'authentication', 'service']  |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L70" target="_blank">auth_mongodb</a>           | ['database', '<a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L72" target="_blank">plaintext_credentials</a>', 'service'] |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L121" target="_blank">statistics_mongodb</a>     | ['database', '<a href="https://github.com/sqshq/piggymetrics/blob/master/docker-compose.yml#L123" target="_blank">plaintext_credentials</a>', 'service'] |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/config/src/main/resources/shared/notification-service.yml#L37" target="_blank">mail_server</a>            | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/config/src/main/resources/shared/notification-service.yml#L37" target="_blank">mail_server</a>', 'plaintext_credentials',         |
|                                  |           |                        | 'external_entity']                               |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/config/src/main/resources/shared/statistics-service.yml#L25" target="_blank">external_website</a>       | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/config/src/main/resources/shared/statistics-service.yml#L25" target="_blank">external_website</a>', 'external_entity']          |
|                                  | excluded  | <a href="https://github.com/sqshq/piggymetrics/blob/master/turbine-stream-service/src/main/resources/bootstrap.yml#L3" target="_blank">turbine_stream_service</a> | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/turbine-stream-service/src/main/java/com/piggymetrics/turbine/TurbineStreamServiceApplication.java#L6" target="_blank">monitoring_server</a>', 'infrastructural',         |
|                                  |           |                        | 'service']                                       |
| -------------------------------- | --------- | ---------------------- | ------------------------------------------------ |
| Final scope                      |           | <a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/resources/bootstrap.yml#L3" target="_blank">gateway</a>                |                                                  |
| -------------------------------- | --------- | ---------------------- | ------------------------------------------------ |
| ### Property checks ###          |           |                        |                                                  |
| -------------------------------- | --------- | ---------------------- | ------------------------------------------------ |
| 2. all_have("authorization")     | fails     | <a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/resources/bootstrap.yml#L3" target="_blank">gateway</a>                | ['<a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/java/com/piggymetrics/gateway/GatewayApplication.java#L10" target="_blank">gateway</a>', 'infrastructural', '<a href="https://github.com/sqshq/piggymetrics/blob/master/gateway/src/main/java/com/piggymetrics/gateway/GatewayApplication.java#L10" target="_blank">load_balancer</a>',  |
|                                  |           |                        | 'circuit_breaker', 'entrypoint', 'service']      |
|                                  | --------- | ---------------------- | ------------------------------------------------ |
|                         Verdict  | False     |                        | Property check requires all nodes to have        |
|                                  |           |                        | annotation "authorization", but none in the      |
|                                  |           |                        | scope has it                                     |
+----------------------------------+-----------+------------------------+--------------------------------------------------+
</pre>    </body>    </html>